using System;
using System.Diagnostics;
using System.Threading;
using Microsoft.SPOT;
using CMSIS;

namespace FastGRNN
{
    public class Program
    {
        public static void Main()
        {
            Debug.Print("5 sec sleep...Connect Logic Analyzer now!");
            /*Initial sleep*/
            Thread.Sleep(5000);

            /*Begin user input*/
            float[] weight_d = { -0.807291f, 0.054143f, -0.148830f, 0.183069f, 0.404488f, 0.707980f, 0.527930f, 0.877890f, -0.259793f, 0.845178f, -0.007380f, 1.923690f, 0.268987f, -1.189658f, -1.024323f, -0.384940f, -1.356056f, 0.632008f, 0.305551f, 0.779431f, 1.759865f, -1.213363f, 2.544312f, 0.398587f, -2.167474f, -0.412874f, 0.140635f, 0.478601f, 0.970677f, -1.772175f, 2.474926f, -0.858927f };
            float[] weight_hh_d = { 0.095296f, -0.094757f, -0.167785f, -0.048441f, -0.119560f, 0.223966f, -0.026868f, -0.062044f, 0.008684f, 0.157768f, -0.260443f, 0.127656f, 0.142844f, -0.139087f, -0.265670f, -0.042686f, -0.140354f, 0.132777f, -0.012269f, -0.054090f, 0.004996f, -0.215220f, -0.337669f, -0.274117f, 0.032089f, -0.152319f, -0.008621f, 0.119962f, -0.421117f, -0.112611f, -0.286470f, 0.350018f, -0.370852f, 0.026803f, 0.185052f, -0.072138f, -0.012923f, -0.380921f, -0.063776f, -0.129190f, -0.031414f, -0.112181f, 0.027522f, -0.103328f, -0.278160f, -0.153880f, 0.027692f, -0.030082f, -0.143446f, -0.029842f, -0.024482f, -0.078337f, -0.065087f, 0.452156f, 0.068704f, -0.065161f, 0.020324f, 0.132691f, -0.140195f, -0.082441f, 0.003262f, 0.008299f, -0.375984f, -0.427066f, -0.039452f, 0.133458f, 0.086650f, 0.004027f, -0.088567f, -0.119544f, -0.146666f, -0.187629f, 0.245142f, -0.097486f, 0.231028f, -0.139706f, -0.177773f, -0.220417f, -0.515569f, -0.291572f, -0.119163f, 0.035669f, 0.026433f, 0.239184f, 0.027379f, 0.532934f, 0.061440f, -0.092493f, 0.034270f, 0.221838f, -0.182648f, -0.201386f, -0.145751f, 0.068922f, -0.690937f, -0.605899f, 0.165179f, -0.096901f, -0.325785f, 0.171979f, -0.222776f, 0.107114f, 0.009311f, -0.311943f, -0.179049f, 0.206143f, 0.012336f, -0.481572f, -0.175070f, 0.284959f, 0.113791f, -0.539374f, 0.096146f, 0.081400f, -0.193124f, -0.139117f, -0.203427f, 0.034535f, 0.240119f, 0.034113f, 0.032315f, 0.193601f, -0.176622f, -0.058031f, -0.034822f, 0.091305f, 0.165781f, 0.009039f, -0.133916f, 0.074230f, 0.075313f, -0.168746f, 0.269984f, -0.199086f, -0.091068f, -0.184775f, -0.131761f, 0.034491f, -0.044894f, -0.029969f, -0.152212f, -0.141207f, -0.240130f, -0.197781f, -0.013680f, 0.025880f, -0.073957f, 0.189186f, 0.139666f, 0.490411f, -0.055518f, -0.231434f, -0.346435f, -0.061413f, 0.009451f, 0.100625f, -0.372333f, -0.012592f, -0.398752f, -0.223704f, -0.301359f, 0.199858f, 0.022153f, -0.346225f, 0.002330f, -0.850531f, -0.228147f, -0.067157f, 0.098913f, -0.290422f, 1.092212f, 0.352541f, -0.110814f, 0.225351f, -0.390548f, 0.154644f, -0.115320f, -0.062401f, -0.197004f, 0.011147f, -0.233101f, -0.423935f, -0.050704f, -0.110806f, -0.204212f, -0.225399f, 0.263876f, 0.062924f, -0.233863f, 0.017940f, 0.373936f, 0.051745f, 0.225193f, 0.026116f, 0.137963f, 0.153754f, -0.008488f, -0.077943f, -0.231065f, -0.061954f, 0.338705f, -0.204226f, -0.049731f, -0.189403f, -0.089194f, 0.095336f, -0.341446f, -0.424124f, 0.198796f, -0.179291f, -0.252742f, 0.198832f, 0.084339f, 0.280105f, 0.045309f, -0.012162f, 0.197257f, 0.089337f, 0.515444f, -0.051886f, 0.221071f, 0.012652f, -0.586627f, -0.576505f, 0.049291f, -0.116907f, -0.048729f, -0.032367f, -0.105319f, -0.410434f, 0.326631f, -0.065737f, -0.073069f, -0.141285f, -0.512469f, 0.272834f, -0.169589f, 0.085407f, 0.224846f, 0.052239f, 0.185459f, 0.036333f, 0.015072f, -0.174054f, -0.004710f, -0.418777f, 0.291061f, 0.137380f, -0.114493f, -0.029906f, 0.130155f, 0.131421f, -0.326204f, -0.157912f, 0.145731f, 0.163904f };
            float[] weight_ih_d = { 0.222557f, -0.262699f, -0.024119f, 0.064634f, 0.458134f, -0.080916f, 0.032349f, -0.091888f, 0.098388f, -0.512823f, 0.163841f, -0.260286f, 0.557074f, 0.161419f, -0.247796f, -0.252737f, 0.131642f, -0.120850f, -0.178273f, 0.006016f, 0.330613f, -0.170522f, -0.115710f, 0.148491f, 0.428042f, -0.233770f, 0.058651f, 0.445961f, -0.442697f, 0.165113f, -0.230008f, 0.301324f, 0.274770f, -0.267895f, -0.009568f, 0.347459f, -0.085984f, -0.201775f, -0.020205f, 0.052968f, 0.514281f, -0.387221f, 0.095725f, 0.421811f, -0.114677f, 0.266447f, -0.389046f, 0.217325f, 0.029996f, 0.067386f, -0.136256f, -0.025923f, 0.015652f, -0.313656f, -0.336820f, 0.135331f, 0.117917f, 0.311904f, -0.055468f, 0.426640f, -0.204970f, 0.248137f, -0.211688f, 0.016199f, 0.068942f, 0.013122f, -0.139901f, 0.380709f, -0.466074f, 0.142793f, -0.008916f, -0.051247f, 0.139419f, -0.220191f, 0.093582f, 0.322994f, 0.013665f, 0.121270f, -0.058602f, 0.169794f, 0.035120f, 0.164825f, 0.056314f, -0.123586f, -0.016355f, 0.072114f, -0.344923f, -0.117403f, -0.375697f, 0.403167f, 0.061898f, -0.067054f, 0.365363f, 0.222105f, 0.188450f, 0.098553f, -0.418565f, 0.255023f, -0.108439f, -0.004086f, 0.126131f, 0.146235f, -0.378618f, -0.088487f, -0.229656f, -0.140705f, 0.099670f, 0.335039f, -0.205018f, -0.053529f, 0.019391f, 0.092388f, 0.097618f, 0.219178f, 0.012538f, -0.178338f, 0.443639f, 0.517251f, -0.194892f, -0.216401f, -0.113795f, 0.198402f, 0.235259f, -0.222819f, 0.032255f, 0.311890f, -0.025779f, 0.205664f, 0.107801f, 0.112063f, 0.067474f, 0.135057f, 0.168883f, 0.026045f, -0.332496f, -0.078385f, -0.047601f, -0.002009f, 0.256619f, 0.083038f, 0.090367f, 0.187250f, -0.220003f, -0.092718f, 0.087916f, -0.142956f, -0.073055f, -0.018606f, -0.198186f, 0.019623f, -0.078038f, -0.228456f, -0.094193f, 0.128757f, 0.244585f, -0.264860f, -0.216267f, 0.307181f, -0.048640f, 0.126476f, -0.031923f, -0.246318f, 0.122320f, 0.037476f, -0.079300f, 0.046465f, -0.092280f, -0.075132f, -0.042896f, -0.215026f, -0.055118f, -0.137763f, -0.124879f, -0.056627f, -0.058325f, -0.060733f, 0.122898f, -0.040686f, -0.106160f, 0.004890f, -0.177303f, -0.555728f, 0.138595f, -0.139106f, -0.149647f, -0.169599f, -0.197045f, -0.206442f, -0.333872f, 0.291776f, -0.127201f, -0.120739f, 0.149775f, -0.064367f, 0.174151f, -0.016999f, -0.088758f, -0.007959f, -0.155405f, -0.059138f, -0.289479f, -0.172139f, -0.248887f, -0.403000f, 0.039253f, -0.105359f, -0.089591f, -0.316303f, 0.148136f, -0.191341f, -0.236983f, -0.127529f, 0.082342f, -0.549013f, 0.405665f, 0.002050f, -0.139286f, 0.154416f, -0.064317f, -0.097090f, -0.018535f, 0.170147f, 0.019907f, 0.161577f, -0.011208f, -0.059546f, 0.286941f, -0.164491f, -0.262640f, 0.231661f, -0.062413f, 0.008865f, -0.340696f, -0.016079f, 0.012585f, -0.219879f, 0.002142f, 0.029676f, -0.129349f, -0.141708f, -0.178216f, 0.027033f, 0.215674f, -0.132476f, 0.230466f, -0.527433f, 0.280467f, -0.060711f, 0.015775f, 0.039859f, 0.278775f, 0.139421f, 0.362601f, 0.352947f, 0.167975f, 0.058636f, -0.078838f, 0.270290f, 0.170122f, -0.096035f, 0.018460f, -0.250378f, 0.237482f, -0.062723f, -0.174588f, -0.178044f, 0.153325f, -0.140039f, -0.139232f, 0.210786f, 0.252467f, -0.038645f, 0.002238f, 0.107751f, 0.323442f, -0.151654f, -0.014218f, 0.169822f, 0.358606f, -0.140607f, 0.132073f, 0.277321f, 0.154462f, 0.118437f, 0.264012f, 0.407914f, 0.190472f, 0.242032f, 0.050042f, 0.059601f, 0.071622f, 0.088081f, 0.005511f, -0.284459f, 0.363627f, -0.046305f, -0.058008f, 0.185999f, -0.079516f, 0.001580f, 0.073433f, -0.072296f, 0.125453f, 0.055734f, -0.129019f, 0.100474f, 0.260067f, -0.056810f, -0.028657f, 0.340164f, 0.090432f, -0.054359f, 0.179681f, 0.119666f, 0.059927f, 0.264582f, -0.126748f, 0.384354f, 0.196117f, -0.042495f, 0.016865f, -0.155486f, -0.416045f, -0.223905f, -0.007201f, 0.198591f, 0.339423f, -0.055147f, 0.000073f, 0.087638f, -0.203119f, 0.014207f, -0.091822f, 0.028802f, 0.165995f, -0.087843f, -0.097230f, 0.041265f, -0.014200f, 0.109580f, -0.306454f, 0.149150f, -0.152856f, 0.147646f, 0.136794f, -0.077594f, 0.206056f, 0.134403f, -0.083920f, 0.308213f, -0.145628f, -0.023940f, 0.262198f, -0.285507f, -0.277054f, -0.520907f, 0.066004f, 0.093807f, 0.330505f, -0.498682f, 0.239412f, -0.180645f, 0.164839f, 0.271409f, 0.218966f, 0.209452f, 0.110314f, 0.051303f, -0.026650f, -0.005358f, -0.067826f, -0.173242f, -0.191550f, -0.646819f, -0.103870f, 0.096304f, 0.069439f, 0.038006f, -0.040097f, 0.051597f, 0.094015f, 0.308455f, -0.163417f, 0.075581f, -0.097091f, -0.282204f, -0.024080f, -0.337709f, -0.146778f, 0.194130f, 0.303269f, -0.101853f, 0.310332f, 0.052864f, 0.047556f, 0.091589f, 0.278964f, 0.026938f, -0.164399f, -0.037650f, 0.436878f, 0.228830f, -0.076019f, -0.080531f, 0.108732f, -0.469716f, 0.164302f, -0.104122f, 0.271689f, 0.041580f, 0.019797f, 0.009506f, 0.241732f, 0.386104f, -0.221120f, 0.049273f, -0.022797f, -0.202254f, 0.042628f, -0.069167f, -0.114539f, -0.079642f, 0.201183f, 0.165733f, 0.416121f, 0.149464f, 0.087453f, 0.027539f, 0.219280f, -0.029451f, 0.018276f, 0.212674f, -0.006005f, 0.247552f, -0.117738f, 0.224642f, 0.112231f, -0.008201f, 0.021954f, -0.117260f, -0.025519f, -0.012528f, 0.238178f, -0.124273f, 0.341450f, 0.028981f, 0.016481f, 0.301496f, 0.150347f, -0.014293f, -0.048373f, -0.135864f, 0.027767f, -0.533068f, 0.224827f, 0.006799f, -0.008818f, 0.192508f, 0.257486f, 0.048268f, -0.064030f, -0.004845f, -0.032244f, -0.001061f, -0.059212f, 0.066691f, 0.104350f, 0.179880f, -0.041952f, 0.208344f, -0.050791f, -0.178796f, -0.306042f, -0.159161f, 0.051805f, -0.035198f, 0.269782f, 0.241361f, 0.008905f, -0.113223f, -0.397237f, -0.062077f, -0.052884f, -0.383457f, 0.002811f, -0.182478f, 0.159477f, -0.128023f, -0.354018f, 0.429225f, -0.154306f, 0.186542f, 0.004145f, 0.116814f, 0.062904f, 0.091490f, -0.124406f, -0.355966f, 0.079270f, -0.054845f, -0.338529f, 0.354785f, -0.209201f, -0.109550f, -0.139628f, -0.249953f, 0.088102f, -0.266389f, -0.108667f, 0.284838f, 0.242842f, 0.177848f };
            float[] bias_d = { -1.382853f, 0.377250f };
            float[] bias_z_d = { 1.080809f, 1.143059f, 1.067185f, 1.071548f, 0.994298f, 0.968734f, 1.201216f, 0.995048f, 1.069691f, 1.020219f, 1.580706f, 0.989805f, 0.918537f, 1.045085f, 0.694268f, 0.981650f };
            float[] bias_h_d = { 0.859399f, 0.814987f, 0.749016f, 0.930546f, 0.915231f, 0.757144f, 0.912455f, 0.865331f, 0.851570f, 0.934425f, 0.689774f, 0.848360f, 0.958885f, 1.081108f, 0.989481f, 0.902728f };
            float[] input_d = { 2063, 1954, 2128, 1983, 2153, 2058, 2129, 2111, 2081, 2123, 2025, 2108, 1987, 2065, 2001, 2020, 2028, 2017, 2044, 2036, 2042, 2031, 2042, 2004, 2064, 1996, 2106, 2035, 2118, 2091, 2098, 2132, 2047, 2133, 1983, 2092, 1977, 2020, 1999, 1988, 2028, 2002, 2025, 1996, 2042, 2015, 2067, 1997, 2110, 2024, 2142, 2085, 2118, 2145, 2050, 2145, 1982, 2090, 1957, 2009, 1995, 1951, 2069, 1974, 2103, 2027, 2088, 2061, 2073, 2054, 2085, 2045, 2090, 2085, 2067, 2106, 2017, 2080, 1967, 2021, 2014, 1992, 2053, 1990, 2089, 2026, 2094, 2057, 2077, 2049, 2075, 2042, 2098, 2070, 2092, 2111, 2031, 2122, 1956, 2072, 1950, 1994, 1991, 1944, 2060, 1956, 2107, 2006, 2127, 2049, 2131, 2070, 2129, 2112, 2114, 2168, 2020, 2151, 1945, 2086, 1937, 1987, 2005, 1924, 2080, 1949, 2142, 2009, 2149, 2077, 2125, 2122, 2087, 2148, 2049, 2142, 1970, 2101, 1917, 2023, 1949, 1949, 2029, 1919, 2111, 1953, 2164, 2022, 2172, 2099, 2134, 2132, 2075, 2167, 1992, 2126, 1943, 2053, 1943, 1975, 1988, 1935, 2064, 1951, 2136, 2003, 2167, 2074, 2120, 2132, 2057, 2162, 1993, 2125, 1940, 2062, 1947, 1973, 2001, 1917, 2082, 1929, 2159, 1998, 2172, 2094, 2129, 2164, 2058, 2192, 1990, 2158, 1921, 2091, 1923, 1986, 1977, 1930, 2037, 1930, 2129, 1977, 2169, 2040, 2141, 2119, 2106, 2153, 2035, 2151, 1973, 2103, 1940, 2026, 1959, 1952, 2019, 1921, 2103, 1958, 2172, 2032, 2166, 2120, 2112, 2159, 2035, 2151, 1961, 2097, 1947, 2017, 1998, 1963, 2084, 1954, 2139, 2012, 2150, 2090, 2096, 2124, 2014, 2134, 1962, 2097, 1935, 2001, 1980, 1930, 2056, 1939, 2127, 1981, 2163, 2077, 2143, 2149, 2094, 2157, 1990, 2121, 1939, 2059, 1946, 1978, 1994, 1931, 2078, 1952, 2166, 1939, 2170, 2073, 2199, 2146, 2082, 2173, 1971, 2116, 1930, 2018, 1961, 1955, 2089, 2007, 2039, 2023, 2142, 2096, 2168, 2126, 2111, 2203, 1983, 2155, 1923, 2031, 1933, 1957, 2003, 1915, 2088, 1942, 2186, 2032, 2182, 2106, 2126, 2178, 2018, 2174, 1918, 2095, 1911, 1968, 1978, 1892, 2103, 1917, 2177, 2019, 2199, 2150, 2112, 2202, 2001, 2170, 1909, 2070, 1903, 1956, 1971, 1888, 2092, 1905, 2179, 1988, 2212, 2128, 2149, 2206, 2034, 2199, 1920, 2123, 1881, 1998, 1945, 1910, 2056, 1915, 2170, 1988, 2181, 2108, 2091, 2186, 2004, 2163, 1946, 2058, 1951, 1962, 2032, 1931, 2116, 1975, 2161, 2080, 2130, 2148, 2055, 2153, 1990, 2099, 1943, 2007, 1988, 1940, 2082, 1941, 2156, 2022, 2156, 2105, 2086, 2147, 2000, 2131, 1942, 2058, 1967, 1981, 2027, 1940, 2106, 1960, 2167, 2049, 2146, 2132, 2089, 2173, 1958, 2117, 1907, 2012, 1958, 1918, 2041, 1924, 2138, 1985, 2194, 2101, 2135, 2183, 2030, 2184, 1922, 2114, 1897, 1975, 1973, 1895, 2094, 1923, 2217, 2024, 2209, 2133, 2103, 2210, 1958, 2164, 1865, 2027, 1900, 1910, 2025, 1863, 2184, 1937, 2250, 2094, 2205, 2231, 2049, 2249, 1913, 2135, 1853, 1976, 1941, 1858, 2098, 1873, 2235, 2007, 2247, 2180, 2121, 2243, 1946, 2226, 1846, 2082, 1855, 1914, 1993, 1840, 2141, 1916, 2212, 2057, 2173, 2158, 2066, 2192, 1960, 2117, 1929, 2002, 1969, 1927, 2074, 1912, 2183, 1995, 2208, 2114, 2115, 2200, 1994, 2176, 1901, 2052, 1918, 1923, 2015, 1865, 2157, 1960, 2218, 2110, 2151, 2220, 2017, 2197, 1894, 2067, 1914, 1940, 2023, 1882, 2156, 1940, 2227, 2105, 2201, 2192, 2050, 2236, 1895, 2146, 1835, 1973, 1915, 1853, 2086, 1828, 2248, 1956, 2287, 2148, 2167, 2287, 1999, 2270, 1856, 2117, 1822, 1939, 1940, 1814, 2124, 1849, 2266, 2019, 2258, 2209, 2096, 2260, 1941, 2204, 1838, 2042, 1874, 1984, 2006, 1840, 2148, 1892, 2251, 2027, 2216, 2183, 2088, 2232, 1965, 2162, 1888, 2021, 1936, 1922, 2047, 1908, 2156, 1986, 2182, 2116, 2112, 2206, 2013, 2181, 1914, 2063, 1903, 1928, 1996, 1866, 2120, 1892, 2235, 2016, 2233, 2170, 2122, 2242, 1982, 2194, 1883, 2067, 1894, 1943, 1994, 1858, 2103, 1906, 2205, 2011, 2199, 2137, 2103, 2196, 1997, 2173, 1920, 2060, 1933, 1943, 2010, 1921, 2114, 1945, 2185, 2060, 2156, 2159, 2068, 2186, 1963, 2113, 1919, 1999, 1968, 1935, 2061, 1942, 2138, 2005, 2157, 2088, 2123, 2133, 2035, 2128, 1986, 2099, 1961, 2037, 1966, 1981, 2013, 1955, 2046, 1869, 2128, 1985, 2174, 2116, 2123, 2185, 2032, 2189, 1934, 2119, 1877, 2006, 1923, 1902, 2024, 1848, 2158, 1906, 2252, 2056, 2203, 2210, 2099, 2261, 1937, 2193, 1845, 2039, 1897, 1895, 2023, 1836, 2171, 1908, 2242, 2068, 2191, 2214, 2029, 2236, 1887, 2132, 1857, 1980, 1944, 1856, 2092, 1857, 2219, 1985, 2262, 2134, 2167, 2249, 2010, 2251, 1856, 2126, 1829, 1968, 1918, 1848, 2073, 1841, 2216, 1946, 2280, 2125, 2202, 2246, 2042, 2253, 1890, 2155, 1843, 1991, 1909, 1864, 2065, 1854, 2204, 1956, 2254, 2113, 2158, 2238, 2026, 2230, 1898, 2123, 1865, 1994, 1939, 1884, 2077, 1868, 2200, 1941, 2255, 2094, 2195, 2213, 2065, 2245, 1938, 2177, 1839, 2066, 1865, 1914 };
            //double[] input_d = {2033,2041,2006,2001,2028,2008,1987,1963,2029,2015,1985,1963,1990,1978,1983,1981,1978,1963,1990,2013,1974,1990,1991,2005,1984,1994,2015,2003,1984,1988,1968,1975,1964,1989,1968,1992,1998,2012,1989,2003,2017,2025,1983,2005,1999,2023,1997,1963,1979,1937,1992,1972,1988,1997,2027,2012,1990,1963,2043,2010,1997,1966,2028,1993,1988,1972,2001,1956,1992,1994,2005,1993,2025,1997,1994,1983,2012,2002,2000,1962,2027,1991,2010,1954,1976,1976,1981,1969,1945,1982,1979,1999,1969,1975,1995,2012,2004,2010,2012,2001,2008,1974,1997,1976,2001,1991,1977,1966,2002,1981,1985,1978,1985,2019,1975,2003,2013,2012,1983,1963,2020,2008,1983,1979,1964,1977,1962,2003,1965,1995,1999,2034,1989,1986,1995,2012,2005,1966,2031,2002,2000,1970,1985,1973,1997,1983,1988,1961,1978,2000,1969,1975,1998,2045,1978,2015,2039,2028,1984,1991,2017,2023,2006,1980,1972,1968,2001,1989,1988,1947,1982,2011,1962,1973,2013,2015,1982,2001,2034,2015,2007,1961,2011,1960,2006,1980,1985,1975,1995,2013,1960,1993,2008,2033,1990,1999,2019,1989,2000,1971,2020,1968,1990,1988,1980,1942,1981,2015,1942,2005,1974,2033,1969,1973,1993,2018,1973,1987,2012,2028,1995,1976,2029,1956,2030,1978,1991,1962,1986,1989,1953,1988,1975,1992,1964,1978,2036,2014,1989,1961,2014,1984,2010,1987,1988,1964,2024,1980,1980,1955,1996,1987,1992,1983,2027,2033,1987,2001,2012,1979,1977,1966,2008,1973,2015,1997,1992,1963,1999,2005,1971,1967,2026,2020,2001,1996,2006,2040,1992,2000,2002,2000,1992,2000,1973,1988,2017,2005,1973,1962,1997,1985,1960,1987,1997,2013,1986,2022,2025,2022,1986,1978,1996,1972,2023,2001,2010,1992,1998,2003,1957,1985,2014,2043,1989,2029,2018,1988,1990,1989,1994,2014,1991,1980,1972,1955,1983,1989,1950,1987,2003,2043,1996,2019,2000,2020,1990,2005,2006,1981,1975,1973,1970,2002,1989,2009,1983,1984,1978,2018,1953,1989,2014,2001,1986,1982,1992,2018,1963,1972,1991,1976,2017,1985,1988,1972,1982,1995,1979,2006,2038,2006,2002,1968,2008,2024,1992,1980,2000,1973,2008,2009,1981,1953,1997,2007,1975,1995,1992,2025,2011,1970,2022,2016,2027,1980,2012,1975,1986,1971,1952,1964,1960,1982,1978,1984,1993,2011,2000,1995,2011,2030,1994,1970,1998,1964,1987,2005,1958,1984,1978,1990,1951,2004,1979,2010,1970,1993,1984,2012,1981,1993,1988,1989,1983,1994,1958,1941,1963,1979,1973,1989,1978,2018,1996,1995,2004,2031,1985,1958,2018,1965,2014,1978,1975,1946,2008,1999,1998,1984,2028,2026,1982,2003,2009,2029,1978,1977,2009,1940,2012,1980,1968,1974,1996,1997,1970,1955,2016,2019,2003,1951,2006,2005,1975,1971,2002,1978,2004,1994,1963,1971,2013,1986,1982,1977,1999,2001,1970,1996,2009,2017,1988,1982,1996,1963,1997,1989,1968,1987,2015,2005,1990,1978,2011,2021,1970,1999,2003,2020,1977,1993,2001,1982,2012,1946,2006,1952,2023,1998,2001,1970,1993,2004,1998,1994,2010,2023,1988,2009,1988,2017,2006,1975,1994,1958,2030,1999,1980,1955,2021,1969,1987,1952,2000,1976,1977,1974,2001,1994,1977,1961,2013,1981,2029,2013,1989,1962,1995,1989,1976,1977,2009,1998,1967,2000,2023,2017,2011,1991,2012,1997,2004,1994,1988,1974,2009,1980,1981,1969,2010,2027,1963,1985,1999,2013,1968,1959,2016,2018,1991,2004,1993,1952,2037,1998,2009,1985,2018,1990,1975,1976,1991,2010,1964,2006,2015,2051,1995,2046,1992,1987,2021,1996,1975,1974,2017,1996,1975,1972,2001,2006,1960,1941,2023,2005,2036,1980,2020,1999,2016,1982,1988,1948,2010,1981,2000,1973,1986,2016,1980,1987,1981,2013,1989,1989,1995,1993,1997,1978,2003,1976,1999,2002,1985,1967,1981,2000,1973,1979,2015,2011,1974,1980,1986,2032,1980,1975,1998,1982,2012,1990,1995,1976,2004,2010,1986,1976,1989,2012,1970,1987,1986,2000,1977,1986,2003,2032,2011,2001,2019,1958,2011,1986,1966,1964,1995,1990,1975,1992,1986,2018,1960,1992,2021,2020,2021,2008,1996,1997,2020,2013,1970,1981,2001,2009,1973,1969,1974,2008,1964,1980,2008,2034,2004,1982,1978,1975,1984,1988,1994,1971,2004,1995,1997,1963,2007,2014,1986,1989,1984,2010,1977,1992,1989,2008,1995,2004,2008,1981,2021,2003,1956,1975,1988,1984,1973,1991};
            float mean = 2039.426298f; float std = 180.046503f;
            float zeta = 6.016959f; float nu = -5.950761f;

            var weight = new Matrix(16, 2, weight_d);
            var weight_ih = new Matrix(32, 16, weight_ih_d);
            var weight_hh = new Matrix(16, 16, weight_hh_d);
            var bias = new Vector(bias_d);
            var bias_z = new Vector(bias_z_d);
            var bias_h = new Vector(bias_h_d);
            uint window = 32;
            int stride = 16;
            /*End user input*/

            // Create FastGRNN object
            fastgrnn_v1 ins1;
            ins1 = new fastgrnn_v1(weight_ih, weight_hh, bias_z, bias_h, zeta, nu);

            Vector input_norm = new Vector(Normalize(input_d, mean, std));
            
            // Run FastGRNN to get logits
            Vector logits = weight.Transpose() * ins1.fastgrnn_calculations(input_norm, window, stride) + bias;
            
            // Print logits
            Debug.Print("Logits: ");
            foreach(var item in logits.GetData())
                Debug.Print(""+item);
        }

        private static float[] Normalize(float[] input, float mean, float std)
        {
            float[] norm = new float[input.Length];

            for (int i = 0; i < norm.Length; i++)
            {
                norm[i] = (input[i] - mean) / std;
            }
            return norm;
        }
    }
}
